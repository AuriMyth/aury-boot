# Foundation Kit åŠŸèƒ½å¯¹æ¯”åˆ†æ

## ğŸ¯ æ–‡æ¡£ç›®æ ‡

å…¨é¢å¯¹æ¯” AuriMyth Foundation Kit ä¸ä¸»æµé¡¶çº§æ¡†æ¶çš„åŠŸèƒ½å·®è·ï¼Œæ˜ç¡®ï¼š
- âœ… **çœŸå®å·®è·**ï¼šé¡¶çº§æ¡†æ¶åŸç”Ÿæä¾›ï¼ŒKit ç¼ºå¤±çš„åŠŸèƒ½
- âœ… **ä¼ä¸šçº§é€šç”¨éœ€æ±‚**ï¼šæ‰€æœ‰æ¡†æ¶éƒ½éœ€è¦ç¬¬ä¸‰æ–¹æ”¯æŒçš„åŠŸèƒ½
- âœ… **Core å±‚ä¼˜åŒ–**ï¼šæ¡†æ¶æ ¸å¿ƒèƒ½åŠ›çš„æ·±åº¦ä¼˜åŒ–å»ºè®®

**å¯¹æ¯”æ¡†æ¶**ï¼š
- **Python**: Django, Flask, FastAPI
- **Java**: Spring Boot
- **PHP**: Laravel
- **Ruby**: Rails
- **Node.js**: NestJS, Express

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”æ€»è§ˆè¡¨

| åŠŸèƒ½æ¨¡å— | Django | Spring Boot | Laravel | Rails | FastAPI | NestJS | **Kit** | å·®è·ç±»å‹ |
|---------|--------|------------|---------|-------|---------|--------|---------|---------|
| **æ ¸å¿ƒæ¡†æ¶** |
| è·¯ç”±ç³»ç»Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |
| ä¸­é—´ä»¶ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |
| ä¾èµ–æ³¨å…¥ | âš ï¸ åŸºç¡€ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |
| ç»„ä»¶åŒ–æ¶æ„ | âœ… Apps | âœ… Beans | âœ… Service Providers | âœ… Engines | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Modules | âœ… Components | - |
| **æ•°æ®è®¿é—®** |
| ORM | âœ… Django ORM | âœ… JPA/Hibernate | âœ… Eloquent | âœ… ActiveRecord | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… TypeORM | âš ï¸ SQLAlchemyï¼ˆç»‘å®šï¼‰ | ğŸ”´ éœ€æŠ½è±¡ |
| æ•°æ®åº“è¿ç§» | âœ… åŸç”Ÿ | âœ… Flyway/Liquibase | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… TypeORM | âœ… åŸç”Ÿï¼ˆå®Œæ•´ï¼‰ | - |
| äº‹åŠ¡ç®¡ç† | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |
| Repository æ¨¡å¼ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… JPA Repository | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… ActiveRecord | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… TypeORM | âš ï¸ åŸç”Ÿï¼ˆç»‘å®š SQLAlchemyï¼‰ | ğŸ”´ éœ€æŠ½è±¡ |
| **æµ‹è¯•æ¡†æ¶** |
| æµ‹è¯•åŸºç±» | âœ… TestCase | âœ… @SpringBootTest | âœ… TestCase | âœ… Test::Unit | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… TestingModule | âš ï¸ åŸºç¡€ | ğŸ”´ å¢å¼º |
| æµ‹è¯•å®¢æˆ·ç«¯ | âœ… Client | âœ… TestRestTemplate | âœ… TestCase | âœ… IntegrationTest | âœ… TestClient | âœ… TestingModule | âœ… TestClient | - |
| Fixtures | âœ… åŸç”Ÿ | âœ… @Sql | âœ… Factories | âœ… Fixtures | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… TestingModule | âš ï¸ Factory | ğŸŸ¡ å¢å¼º |
| æ•°æ®åº“å›æ»š | âœ… è‡ªåŠ¨ | âœ… @Transactional | âœ… DatabaseTransactions | âœ… è‡ªåŠ¨ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… TestingModule | âœ… è‡ªåŠ¨ | - |
| **å›½é™…åŒ–** |
| i18n/l10n | âœ… åŸç”Ÿ | âœ… MessageSource | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… i18n | âœ… åŸç”Ÿ | - |
| æ—¶åŒºå¤„ç† | âœ… åŸç”Ÿ | âœ… TimeZone | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âš ï¸ åŸºç¡€ï¼ˆå‚æ•°æœªå®ç°ï¼‰ | ğŸŸ¡ å¢å¼º |
| **å®‰å…¨è®¤è¯** |
| è®¤è¯ç³»ç»Ÿ | âœ… åŸç”Ÿ | âœ… Spring Security | âœ… åŸç”Ÿ | âœ… Devise | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Passport | âš ï¸ ç”¨æˆ·æœåŠ¡ | - |
| æˆæƒç³»ç»Ÿ | âœ… Permissions | âœ… @PreAuthorize | âœ… Policies | âœ… CanCan | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Guards | âš ï¸ ç”¨æˆ·æœåŠ¡ | - |
| å¯†ç åŠ å¯† | âœ… åŸç”Ÿ | âœ… BCrypt | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âš ï¸ Passlib | ğŸŸ¡ é›†æˆ |
| JWT æ”¯æŒ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Spring Security | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âš ï¸ PyJWT | ğŸŸ¡ é›†æˆ |
| **å¯è§‚æµ‹æ€§** |
| å¥åº·æ£€æŸ¥ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Actuator | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âš ï¸ åŸºç¡€ | ğŸ”´ å¢å¼º |
| æŒ‡æ ‡æ”¶é›† | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Actuator | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âŒ ç¼ºå¤± | ğŸ”´ é«˜ |
| åˆ†å¸ƒå¼è¿½è¸ª | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Sleuth | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âŒ ç¼ºå¤± | ğŸ”´ é«˜ |
| æ—¥å¿—ç³»ç»Ÿ | âœ… åŸç”Ÿ | âœ… Logback | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… Loguru | - |
| **å®‰å…¨åˆè§„** |
| è¯·æ±‚é™æµ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… RateLimiter | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âš ï¸ ç½‘å…³å±‚ | - |
| API Key ç®¡ç† | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Spring Security | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âŒ ç¼ºå¤± | ğŸ”´ é«˜ |
| CORS | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |
| æ•°æ®è„±æ• | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ ç¼ºå¤± | ğŸŸ¡ ä¸­ |
| **é…ç½®ç®¡ç†** |
| ç¯å¢ƒé…ç½® | âœ… Settings | âœ… application.yml | âœ… .env | âœ… config/ | âœ… Pydantic | âœ… ConfigModule | âœ… Pydantic | - |
| å¤šç¯å¢ƒæ”¯æŒ | âœ… åŸç”Ÿ | âœ… Profiles | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âš ï¸ éœ€é…ç½® | âœ… åŸç”Ÿ | âš ï¸ éœ€é…ç½® | ğŸŸ¡ å¢å¼º |
| å¯†é’¥ç®¡ç† | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Vault | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… ConfigModule | âŒ ç¼ºå¤± | ğŸŸ¡ ä¸­ |
| **ä»»åŠ¡è°ƒåº¦** |
| å®šæ—¶ä»»åŠ¡ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… @Scheduled | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… @Cron | âœ… APScheduler | - |
| å¼‚æ­¥ä»»åŠ¡ | âŒ Celery | âœ… @Async | âŒ Queue | âŒ Sidekiq | âŒ Celery | âœ… Bull | âœ… Dramatiq | - |
| **ç¼“å­˜** |
| ç¼“å­˜æŠ½è±¡ | âœ… åŸç”Ÿ | âœ… Cache Abstraction | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… CacheModule | âœ… åŸç”Ÿ | - |
| å¤šåç«¯æ”¯æŒ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |
| **å­˜å‚¨** |
| å¯¹è±¡å­˜å‚¨ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Storage | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… S3 | - |
| **äº‹ä»¶ç³»ç»Ÿ** |
| äº‹ä»¶æ€»çº¿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… ApplicationEvent | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… EventEmitter | âœ… åŸç”Ÿ | - |
| **RPC é€šä¿¡** |
| RPC æ¡†æ¶ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… Feign | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âŒ éœ€ç¬¬ä¸‰æ–¹ | âœ… åŸç”Ÿ | âœ… åŸç”Ÿ | - |

**å›¾ä¾‹**ï¼š
- âœ… åŸç”Ÿæ”¯æŒ
- âš ï¸ åŸºç¡€æ”¯æŒï¼ˆéœ€å¢å¼ºï¼‰
- âŒ ç¼ºå¤±æˆ–éœ€ç¬¬ä¸‰æ–¹
- ğŸ”´ é«˜ä¼˜å…ˆçº§å·®è·
- ğŸŸ¡ ä¸­ä¼˜å…ˆçº§å·®è·

---

## ğŸ”´ ç¬¬ä¸€éƒ¨åˆ†ï¼šçœŸå®å·®è·ï¼ˆé¡¶çº§æ¡†æ¶åŸç”Ÿæä¾›ï¼ŒKit ç¼ºå¤±ï¼‰

### æ¦‚è¿°

è¿™äº›åŠŸèƒ½åœ¨**è‡³å°‘ 3 ä¸ªé¡¶çº§æ¡†æ¶ä¸­éƒ½æœ‰åŸç”Ÿæ”¯æŒ**ï¼Œä½† Foundation Kit ç¼ºå¤±ã€‚è¿™æ˜¯ Kit ä¸é¡¶çº§æ¡†æ¶çš„çœŸå®å·®è·ã€‚

---

### 1. **è®¤è¯å’Œæˆæƒç³»ç»Ÿ** â­â­â­â­â­

#### æ¶æ„è¯´æ˜ï¼š
- **Kit è®¾è®¡**ï¼šé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œè®¤è¯æˆæƒç”±ç‹¬ç«‹çš„**ç”¨æˆ·æœåŠ¡**æä¾›ï¼ˆç±»ä¼¼ Spring Cloudï¼‰
- **å…¶ä»–æ¡†æ¶**ï¼šå•ä½“åº”ç”¨ï¼Œè®¤è¯æˆæƒå†…ç½®åœ¨æ¡†æ¶ä¸­

#### é¡¶çº§æ¡†æ¶æ”¯æŒæƒ…å†µï¼š
- **Django**: âœ… `django.contrib.auth` - å®Œæ•´çš„è®¤è¯æˆæƒç³»ç»Ÿï¼ˆå•ä½“åº”ç”¨ï¼‰
- **Spring Boot**: âœ… `Spring Security` - ä¼ä¸šçº§å®‰å…¨æ¡†æ¶ï¼ˆå•ä½“åº”ç”¨ï¼‰
- **Spring Cloud**: âš ï¸ ç”¨æˆ·æœåŠ¡ - è®¤è¯æˆæƒç”±ç‹¬ç«‹æœåŠ¡æä¾›ï¼ˆå¾®æœåŠ¡æ¶æ„ï¼‰
- **Laravel**: âœ… `Auth` + `Policies` - å®Œæ•´çš„è®¤è¯æˆæƒï¼ˆå•ä½“åº”ç”¨ï¼‰
- **Rails**: âœ… `Devise` + `CanCan` - è®¤è¯æˆæƒ Gemï¼ˆå•ä½“åº”ç”¨ï¼‰
- **NestJS**: âœ… `Passport` + `Guards` - å®Œæ•´çš„è®¤è¯æˆæƒï¼ˆå•ä½“åº”ç”¨ï¼‰
- **FastAPI**: âŒ éœ€ç¬¬ä¸‰æ–¹ï¼ˆ`fastapi-users`, `python-jose`ï¼‰

#### Kit ç°çŠ¶ï¼š
- âš ï¸ **ç”±ç”¨æˆ·æœåŠ¡æä¾›**ï¼ˆå¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼‰
- Foundation Kit ä¸åŒ…å«è®¤è¯æˆæƒç³»ç»Ÿ
- è®¤è¯æˆæƒç”±ç‹¬ç«‹çš„ç”¨æˆ·æœåŠ¡ï¼ˆUser Serviceï¼‰æä¾›
- é€šè¿‡ RPC æˆ– API è°ƒç”¨ç”¨æˆ·æœåŠ¡è¿›è¡Œè®¤è¯æˆæƒ

#### æ¶æ„ä¼˜åŠ¿ï¼š
- âœ… æœåŠ¡è§£è€¦ï¼šè®¤è¯æˆæƒç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•
- âœ… ç»Ÿä¸€ç®¡ç†ï¼šæ‰€æœ‰æœåŠ¡å…±äº«åŒä¸€è®¤è¯æˆæƒæœåŠ¡
- âœ… çµæ´»æ‰©å±•ï¼šå¯ä»¥æ›¿æ¢ä¸åŒçš„è®¤è¯æˆæƒå®ç°
- âœ… ç¬¦åˆå¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ

#### ä½¿ç”¨æ–¹å¼ï¼š
```python
# é€šè¿‡ RPC è°ƒç”¨ç”¨æˆ·æœåŠ¡
from aurimyth.foundation_kit.application.rpc import RPCClient

rpc_client = RPCClient("user-service")

# éªŒè¯ Token
user = await rpc_client.call("auth.verify_token", token=token)

# æ£€æŸ¥æƒé™
has_permission = await rpc_client.call("auth.check_permission", 
                                       user_id=user.id, 
                                       permission="user.create")
```

**ç»“è®º**ï¼šâœ… **è®¾è®¡å†³ç­–**ï¼Œä¸æ˜¯ç¼ºå¤±åŠŸèƒ½ã€‚Kit é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œè®¤è¯æˆæƒç”±ç”¨æˆ·æœåŠ¡æä¾›ï¼Œç¬¦åˆ Spring Cloud ç­‰å¾®æœåŠ¡æ¡†æ¶çš„è®¾è®¡ç†å¿µã€‚

---

### 2. **å¯è§‚æµ‹æ€§ï¼ˆObservabilityï¼‰** â­â­â­â­â­

#### é¡¶çº§æ¡†æ¶æ”¯æŒæƒ…å†µï¼š
- **Spring Boot**: âœ… `Actuator` - å®Œæ•´çš„ç›‘æ§å’Œå¥åº·æ£€æŸ¥
- **NestJS**: âœ… åŸç”Ÿæ”¯æŒ - å¥åº·æ£€æŸ¥ã€æŒ‡æ ‡ã€è¿½è¸ª
- **Django**: âŒ éœ€ç¬¬ä¸‰æ–¹ï¼ˆ`django-health-check`, `django-prometheus`ï¼‰
- **Laravel**: âŒ éœ€ç¬¬ä¸‰æ–¹ï¼ˆ`laravel-health`ï¼‰
- **Rails**: âŒ éœ€ç¬¬ä¸‰æ–¹
- **FastAPI**: âŒ éœ€ç¬¬ä¸‰æ–¹

#### Kit ç°çŠ¶ï¼š
- âš ï¸ **åŸºç¡€æ”¯æŒ**ï¼ˆåªæœ‰ç®€å•çš„å¥åº·æ£€æŸ¥ï¼‰
- âŒ æ— æŒ‡æ ‡æ”¶é›†ï¼ˆPrometheusï¼‰
- âŒ æ— åˆ†å¸ƒå¼è¿½è¸ªï¼ˆOpenTelemetryï¼‰
- âŒ æ— æ€§èƒ½ç›‘æ§

#### å½±å“ï¼š
- ç”Ÿäº§ç¯å¢ƒéš¾ä»¥ç›‘æ§
- æ— æ³•è¿½è¸ªæ€§èƒ½ç“¶é¢ˆ
- éš¾ä»¥å®šä½åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜

#### å»ºè®®è¡¥å……ï¼š

##### 2.1 å¥åº·æ£€æŸ¥å¢å¼º
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.observability.health import health_check, HealthStatus

@router.get("/health")
async def health():
    return await health_check({
        "database": check_database,
        "cache": check_cache,
        "storage": check_storage,
        "external_api": check_external_api,
    })
```

##### 2.2 æŒ‡æ ‡æ”¶é›†ï¼ˆPrometheusï¼‰
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.observability.metrics import MetricsCollector

metrics = MetricsCollector()
metrics.increment("http.requests", tags={"method": "GET", "status": "200"})
metrics.histogram("http.duration", duration_ms, tags={"endpoint": "/users"})
metrics.gauge("active.connections", count)
```

##### 2.3 åˆ†å¸ƒå¼è¿½è¸ªï¼ˆOpenTelemetryï¼‰
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.observability.tracing import trace

@trace("user_service.create_user")
async def create_user(data):
    # è‡ªåŠ¨æ³¨å…¥ trace context
    pass
```

**ä¼˜å…ˆçº§**ï¼šğŸ”´ **æé«˜**ï¼ˆä¼ä¸šçº§åº”ç”¨å¿…éœ€ï¼Œç”Ÿäº§ç¯å¢ƒç›‘æ§ï¼‰

---

### 3. **å®‰å…¨åˆè§„ï¼ˆSecurity & Complianceï¼‰** â­â­â­â­â­

#### æ¶æ„è¯´æ˜ï¼š
- **é™æµ**ï¼šåº”è¯¥åœ¨**ç½‘å…³å±‚**ï¼ˆAPI Gatewayï¼‰å®ç°ï¼Œè€Œä¸æ˜¯åº”ç”¨å±‚
- **API Key ç®¡ç†**ï¼šå¯ä»¥åœ¨ç½‘å…³å±‚æˆ–åº”ç”¨å±‚å®ç°
- **æ•°æ®è„±æ•**ï¼šåº”ç”¨å±‚åŠŸèƒ½ï¼Œç”¨äºå“åº”æ•°æ®è„±æ•

#### é¡¶çº§æ¡†æ¶æ”¯æŒæƒ…å†µï¼š
- **Spring Boot**: âœ… `RateLimiter` - Spring Security æä¾›ï¼ˆåº”ç”¨å±‚ï¼‰
- **Spring Cloud Gateway**: âœ… ç½‘å…³å±‚é™æµï¼ˆæ¨èï¼‰
- **NestJS**: âœ… åŸç”Ÿæ”¯æŒ - é™æµã€API Keyï¼ˆåº”ç”¨å±‚ï¼‰
- **Kong/Envoy**: âœ… ç½‘å…³å±‚é™æµï¼ˆå¾®æœåŠ¡æ¶æ„æ¨èï¼‰
- **Django**: âŒ éœ€ç¬¬ä¸‰æ–¹ï¼ˆ`django-ratelimit`ï¼‰
- **Laravel**: âŒ éœ€ç¬¬ä¸‰æ–¹ï¼ˆ`laravel-rate-limiter`ï¼‰
- **Rails**: âŒ éœ€ç¬¬ä¸‰æ–¹
- **FastAPI**: âŒ éœ€ç¬¬ä¸‰æ–¹

#### Kit ç°çŠ¶ï¼š
- âš ï¸ **é™æµç”±ç½‘å…³å±‚æä¾›**ï¼ˆæ¶æ„è®¾è®¡å†³ç­–ï¼‰
- âš ï¸ **API Key ç®¡ç†**ï¼šå¯ç”±ç½‘å…³å±‚æˆ–ç”¨æˆ·æœåŠ¡æä¾›
- âŒ æ— æ•°æ®è„±æ•å·¥å…·

#### æ¶æ„è®¾è®¡ï¼š

##### 3.1 è¯·æ±‚é™æµï¼ˆç½‘å…³å±‚ï¼‰

**è®¾è®¡å†³ç­–**ï¼š
- é™æµåº”è¯¥åœ¨**API Gateway**å±‚å®ç°ï¼Œè€Œä¸æ˜¯åº”ç”¨å±‚
- ä¼˜åŠ¿ï¼š
  - ç»Ÿä¸€é™æµç­–ç•¥ï¼šæ‰€æœ‰æœåŠ¡å…±äº«åŒä¸€é™æµè§„åˆ™
  - æ€§èƒ½ä¼˜åŒ–ï¼šåœ¨ç½‘å…³å±‚æ‹¦æˆªï¼Œå‡å°‘åç«¯æœåŠ¡å‹åŠ›
  - é›†ä¸­ç®¡ç†ï¼šé™æµè§„åˆ™é›†ä¸­é…ç½®å’Œç®¡ç†
  - åˆ†å¸ƒå¼é™æµï¼šç½‘å…³å±‚æ›´å®¹æ˜“å®ç°åˆ†å¸ƒå¼é™æµ

**ç½‘å…³å±‚é™æµæ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ **Kong**ã€**Envoy**ã€**Traefik** ç­‰ API Gateway
- æˆ–ä½¿ç”¨ **Nginx** + **lua-resty-limit-traffic**
- æˆ–è‡ªå»ºç½‘å…³æœåŠ¡ï¼ˆä½¿ç”¨ Foundation Kit æ„å»ºï¼‰

**åº”ç”¨å±‚é™æµï¼ˆå¯é€‰è¡¥å……ï¼‰**ï¼š
- å¯ä½œä¸ºç½‘å…³é™æµçš„è¡¥å……
- ç”¨äºç»†ç²’åº¦é™æµï¼ˆå¦‚ç‰¹å®šæ¥å£é™æµï¼‰
- ç”¨äºç½‘å…³ä¸å¯ç”¨æ—¶çš„é™çº§æ–¹æ¡ˆ

##### 3.2 API Key ç®¡ç†

**è®¾è®¡å†³ç­–**ï¼š
- å¯ä»¥åœ¨ç½‘å…³å±‚æˆ–åº”ç”¨å±‚å®ç°
- æ¨èï¼šç½‘å…³å±‚ç»Ÿä¸€éªŒè¯ï¼Œåº”ç”¨å±‚å¯é€‰æ‹©æ€§éªŒè¯

**æ–¹æ¡ˆä¸€ï¼šç½‘å…³å±‚éªŒè¯ï¼ˆæ¨èï¼‰**
- API Gateway ç»Ÿä¸€éªŒè¯ API Key
- éªŒè¯é€šè¿‡åè½¬å‘è¯·æ±‚åˆ°åç«¯æœåŠ¡
- åç«¯æœåŠ¡æ— éœ€å…³å¿ƒ API Key éªŒè¯

**æ–¹æ¡ˆäºŒï¼šåº”ç”¨å±‚éªŒè¯**
- æ¯ä¸ªæœåŠ¡è‡ªå·±éªŒè¯ API Key
- é€šè¿‡ä¸­é—´ä»¶æˆ–è£…é¥°å™¨å®ç°
- é€‚åˆéœ€è¦ç»†ç²’åº¦æ§åˆ¶çš„åœºæ™¯

**æ–¹æ¡ˆä¸‰ï¼šç”¨æˆ·æœåŠ¡éªŒè¯ï¼ˆæ¨èï¼Œä¸è®¤è¯ç»Ÿä¸€ï¼‰**
- API Key éªŒè¯ç”±ç”¨æˆ·æœåŠ¡æä¾›
- ç½‘å…³å±‚æˆ–åº”ç”¨å±‚è°ƒç”¨ç”¨æˆ·æœåŠ¡éªŒè¯
- ä¸è®¤è¯æˆæƒç»Ÿä¸€ç®¡ç†

##### 3.3 æ•°æ®è„±æ•

**è®¾è®¡**ï¼š
- åº”ç”¨å±‚åŠŸèƒ½ï¼Œç”¨äºå“åº”æ•°æ®è„±æ•
- æä¾›å·¥å…·å‡½æ•°ï¼Œä¸ä¾èµ–å¤–éƒ¨æœåŠ¡

**å»ºè®®è¡¥å……**ï¼š
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.security.masking import mask_phone, mask_email, mask_id_card

masked = mask_phone("13800138000")  # "138****8000"
masked = mask_email("user@example.com")  # "u***@example.com"
masked = mask_id_card("110101199001011234")  # "110101********1234"
```

**ä¼˜å…ˆçº§**ï¼š
- **é™æµ**ï¼šâœ… ç”±ç½‘å…³å±‚æä¾›ï¼ˆæ¶æ„è®¾è®¡ï¼‰
- **API Key**ï¼šğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆå¯ç”±ç½‘å…³å±‚æˆ–ç”¨æˆ·æœåŠ¡æä¾›ï¼‰
- **æ•°æ®è„±æ•**ï¼šğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆåº”ç”¨å±‚å·¥å…·ï¼‰

---

### 4. **æµ‹è¯•æ¡†æ¶å¢å¼º** â­â­â­â­

#### é¡¶çº§æ¡†æ¶æ”¯æŒæƒ…å†µï¼š
- **Django**: âœ… `TestCase`, `Fixtures` - å®Œæ•´çš„æµ‹è¯•æ¡†æ¶
- **Spring Boot**: âœ… `@SpringBootTest`, `@Sql` - å®Œæ•´çš„æµ‹è¯•æ”¯æŒ
- **Laravel**: âœ… `TestCase`, `Factories` - å®Œæ•´çš„æµ‹è¯•æ¡†æ¶
- **Rails**: âœ… `Test::Unit`, `Fixtures` - å®Œæ•´çš„æµ‹è¯•æ¡†æ¶
- **NestJS**: âœ… `TestingModule` - å®Œæ•´çš„æµ‹è¯•æ”¯æŒ
- **FastAPI**: âš ï¸ éœ€ç¬¬ä¸‰æ–¹ï¼ˆ`pytest`, `httpx`ï¼‰

#### Kit ç°çŠ¶ï¼š
- âš ï¸ **åŸºç¡€æ”¯æŒ**
- âœ… æœ‰ `TestCase` åŸºç±»
- âœ… æœ‰ `TestClient`
- âš ï¸ `Factory` åŠŸèƒ½æœ‰é™
- âŒ æ—  Fixtures æ”¯æŒ

#### å½±å“ï¼š
- æµ‹è¯•ç¼–å†™ä¸å¤Ÿä¾¿æ·
- ç¼ºå°‘æµ‹è¯•æ•°æ®ç®¡ç†å·¥å…·

#### å»ºè®®è¡¥å……ï¼š
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.testing import TestCase, TestClient, Factory, Fixtures

class UserServiceTest(TestCase):
    fixtures = ["users.json", "roles.json"]  # è‡ªåŠ¨åŠ è½½ Fixtures
    
    async def setUp(self):
        self.client = TestClient(app)
        self.user_factory = Factory(User)
    
    async def test_create_user(self):
        # Factory æ”¯æŒå…³è”åˆ›å»º
        user = await self.user_factory.create(
            name="å¼ ä¸‰",
            profile__bio="ç®€ä»‹",  # è‡ªåŠ¨åˆ›å»ºå…³è”å¯¹è±¡
        )
        assert user.profile.bio == "ç®€ä»‹"
```

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ **é«˜**ï¼ˆæé«˜å¼€å‘æ•ˆç‡ï¼Œå‡å°‘å­¦ä¹ æˆæœ¬ï¼‰

---

### 5. **æ•°æ®åº“è¿ç§»å·¥å…·** â­â­â­â­

#### é¡¶çº§æ¡†æ¶æ”¯æŒæƒ…å†µï¼š
- **Django**: âœ… `makemigrations`, `migrate` - ä¾¿æ·çš„å‘½ä»¤è¡Œå·¥å…·
- **Laravel**: âœ… `php artisan migrate` - ä¾¿æ·çš„å‘½ä»¤è¡Œå·¥å…·
- **Rails**: âœ… `rails db:migrate` - ä¾¿æ·çš„å‘½ä»¤è¡Œå·¥å…·
- **Spring Boot**: âš ï¸ Flyway/Liquibaseï¼ˆéœ€é…ç½®ï¼‰
- **NestJS**: âœ… TypeORM Migrationï¼ˆä¾¿æ·ï¼‰
- **FastAPI**: âŒ Alembicï¼ˆéœ€æ‰‹åŠ¨ç®¡ç†ï¼‰

#### Kit ç°çŠ¶ï¼š
- âœ… **å®Œæ•´æ”¯æŒ**ï¼ˆå·²å®ç°ï¼‰
- âœ… æœ‰å®Œæ•´çš„å‘½ä»¤è¡Œå·¥å…·ï¼ˆ`aurimyth-migrate`ï¼‰
- âœ… æ”¯æŒæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼š
  - `make` - ç”Ÿæˆè¿ç§»æ–‡ä»¶ï¼ˆè‡ªåŠ¨æ£€æµ‹æ¨¡å‹å˜æ›´ï¼‰
  - `up` - æ‰§è¡Œè¿ç§»
  - `down` - å›æ»šè¿ç§»
  - `status` - æŸ¥çœ‹è¿ç§»çŠ¶æ€
  - `show` - æ˜¾ç¤ºæ‰€æœ‰è¿ç§»ï¼ˆRich è¡¨æ ¼ï¼‰
  - `check` - æ£€æŸ¥è¿ç§»æ–‡ä»¶
  - `merge` - åˆå¹¶è¿ç§»åˆ†æ”¯
  - `history` - æ˜¾ç¤ºè¿ç§»å†å²
- âœ… æ”¯æŒå¹²è¿è¡Œï¼ˆdry-runï¼‰
- âœ… æ”¯æŒè‡ªåŠ¨ç”Ÿæˆï¼ˆautogenerateï¼‰
- âœ… ä½¿ç”¨ Rich è¿›è¡Œå¯è§†åŒ–è¾“å‡º

#### å·²å®ç°åŠŸèƒ½ï¼š
```bash
# ç”Ÿæˆè¿ç§»
aurimyth-migrate make -m "add user table"

# æ‰§è¡Œè¿ç§»
aurimyth-migrate up

# å›æ»šè¿ç§»
aurimyth-migrate down previous

# æŸ¥çœ‹çŠ¶æ€
aurimyth-migrate status

# æ˜¾ç¤ºæ‰€æœ‰è¿ç§»ï¼ˆRich è¡¨æ ¼ï¼‰
aurimyth-migrate show

# æ£€æŸ¥è¿ç§»
aurimyth-migrate check

# åˆå¹¶è¿ç§»
aurimyth-migrate merge "abc123,def456"

# æ˜¾ç¤ºå†å²
aurimyth-migrate history
```

#### å¯é€‰å¢å¼ºï¼ˆéå¿…éœ€ï¼‰ï¼š
- âš ï¸ è¿ç§»å‰å¤‡ä»½ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
- âš ï¸ è¿ç§»å›æ»šç¡®è®¤ï¼ˆå®‰å…¨æç¤ºï¼‰
- âš ï¸ è¿ç§»æ€§èƒ½åˆ†æï¼ˆæ‰§è¡Œæ—¶é—´ç»Ÿè®¡ï¼‰

**ç»“è®º**ï¼šâœ… **å·²å®Œæ•´å®ç°**ï¼ŒåŠŸèƒ½ä¸ Django/Laravel ç›¸å½“ï¼Œæ— éœ€è¡¥å……

---

## ğŸŸ¡ ç¬¬äºŒéƒ¨åˆ†ï¼šä¼ä¸šçº§é€šç”¨éœ€æ±‚ï¼ˆæ‰€æœ‰æ¡†æ¶éƒ½éœ€è¦ç¬¬ä¸‰æ–¹æ”¯æŒï¼‰

### æ¦‚è¿°

è¿™äº›åŠŸèƒ½**æ‰€æœ‰æ¡†æ¶éƒ½éœ€è¦ç¬¬ä¸‰æ–¹åº“æ”¯æŒ**ï¼Œä¸æ˜¯ Kit ç›¸å¯¹äºå…¶ä»–æ¡†æ¶çš„å·®è·ï¼Œè€Œæ˜¯**ä¼ä¸šçº§åº”ç”¨çš„é€šç”¨éœ€æ±‚**ã€‚

---

### 1. **é…ç½®ç®¡ç†å¢å¼º** â­â­â­â­

#### æ‰€æœ‰æ¡†æ¶ç°çŠ¶ï¼š
- **Django**: âš ï¸ åŸºç¡€ï¼ˆ`settings.py`ï¼‰ï¼Œéœ€ `django-environ` å¢å¼º
- **Spring Boot**: âœ… åŸç”Ÿï¼ˆ`application.yml`ï¼‰
- **Laravel**: âš ï¸ åŸºç¡€ï¼ˆ`.env`ï¼‰ï¼Œéœ€ `config` å¢å¼º
- **Rails**: âš ï¸ åŸºç¡€ï¼ˆ`config/`ï¼‰ï¼Œéœ€ `figaro` å¢å¼º
- **NestJS**: âœ… åŸç”Ÿï¼ˆ`ConfigModule`ï¼‰
- **FastAPI**: âš ï¸ åŸºç¡€ï¼ˆPydantic Settingsï¼‰

#### Kit ç°çŠ¶ï¼š
- âš ï¸ **åŸºç¡€æ”¯æŒ**ï¼ˆPydantic Settingsï¼‰
- âœ… æ”¯æŒç¯å¢ƒå˜é‡å’Œ `.env` æ–‡ä»¶
- âŒ ç¼ºå°‘å¤šç¯å¢ƒé…ç½®ç®¡ç†ï¼ˆdev/staging/prodï¼‰
- âŒ ç¼ºå°‘å¯†é’¥ç®¡ç†ï¼ˆVaultã€AWS Secrets Manager ç­‰ï¼‰

#### è®¾è®¡æ–¹æ¡ˆï¼š

##### 1.1 å¤šç¯å¢ƒé…ç½®æ¶æ„

**è®¾è®¡ç›®æ ‡**ï¼š
- æ”¯æŒå¤šç¯å¢ƒï¼ˆdevelopmentã€stagingã€productionï¼‰
- é…ç½®æ–‡ä»¶åˆ†å±‚ï¼ˆbase + environment-specificï¼‰
- é…ç½®ä¼˜å…ˆçº§ï¼šç¯å¢ƒå˜é‡ > ç¯å¢ƒé…ç½®æ–‡ä»¶ > base é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼
- é…ç½®åˆå¹¶ç­–ç•¥ï¼šæ·±åº¦åˆå¹¶ï¼Œç¯å¢ƒé…ç½®è¦†ç›– base é…ç½®

**ç›®å½•ç»“æ„**ï¼š
```
config/
â”œâ”€â”€ base.yaml              # åŸºç¡€é…ç½®ï¼ˆæ‰€æœ‰ç¯å¢ƒå…±äº«ï¼‰
â”œâ”€â”€ development.yaml       # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ staging.yaml           # é¢„å‘å¸ƒç¯å¢ƒé…ç½®
â”œâ”€â”€ production.yaml        # ç”Ÿäº§ç¯å¢ƒé…ç½®
â””â”€â”€ secrets/               # å¯†é’¥é…ç½®ï¼ˆä¸æäº¤åˆ° Gitï¼‰
    â”œâ”€â”€ development.yaml
    â”œâ”€â”€ staging.yaml
    â””â”€â”€ production.yaml
```

**é…ç½®åŠ è½½é¡ºåº**ï¼š
1. åŠ è½½ `base.yaml`ï¼ˆåŸºç¡€é…ç½®ï¼‰
2. åŠ è½½ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼ˆå¦‚ `production.yaml`ï¼‰ï¼Œè¦†ç›– base é…ç½®
3. åŠ è½½ç¯å¢ƒå˜é‡ï¼Œè¦†ç›–æ–‡ä»¶é…ç½®
4. åŠ è½½å¯†é’¥ï¼ˆä» Vault æˆ– secrets æ–‡ä»¶ï¼‰ï¼Œè¦†ç›–æ‰€æœ‰é…ç½®

**ç¯å¢ƒå˜é‡æ§åˆ¶**ï¼š
- `ENV` æˆ– `ENVIRONMENT`ï¼šæŒ‡å®šç¯å¢ƒï¼ˆdevelopment/staging/productionï¼‰
- `CONFIG_DIR`ï¼šé…ç½®æ–‡ä»¶ç›®å½•ï¼ˆé»˜è®¤ `config/`ï¼‰

##### 1.2 å¯†é’¥ç®¡ç†æ¶æ„

**æ¶æ„è®¾è®¡å†³ç­–**ï¼š
- **æ¡†æ¶å†…**ï¼šæä¾›å¯†é’¥ç®¡ç†æ¥å£å’ŒåŸºç¡€å®ç°ï¼ˆç¯å¢ƒå˜é‡ã€æœ¬åœ°æ–‡ä»¶ï¼‰
- **æ’ä»¶**ï¼šé«˜çº§å¯†é’¥ç®¡ç†ï¼ˆVaultã€AWS Secrets Managerï¼‰ä½œä¸ºç‹¬ç«‹æ’ä»¶

**è®¾è®¡ç†ç”±**ï¼š
1. **ä¿æŒæ¡†æ¶è½»é‡**ï¼šä¸æ˜¯æ‰€æœ‰é¡¹ç›®éƒ½éœ€è¦ Vault/AWS
2. **çµæ´»æ‰©å±•**ï¼šä¸åŒé¡¹ç›®å¯ä»¥é€‰æ‹©ä¸åŒçš„å¯†é’¥ç®¡ç†æ–¹æ¡ˆ
3. **ç¬¦åˆæ’ä»¶åŒ–è®¾è®¡**ï¼šåŸºç¡€è®¾æ–½é›†æˆåº”è¯¥ä½œä¸ºæ’ä»¶
4. **å‚è€ƒæœ€ä½³å®è·µ**ï¼šSpring Cloud Vaultã€django-vault éƒ½æ˜¯ç‹¬ç«‹é¡¹ç›®

**æ¡†æ¶å†…æä¾›ï¼ˆæ ¸å¿ƒï¼‰**ï¼š
1. **SecretManager æ¥å£**ï¼ˆæŠ½è±¡å±‚ï¼‰
   - å®šä¹‰å¯†é’¥è·å–æ¥å£
   - æ”¯æŒå¤šç§å®ç°
   
2. **ç¯å¢ƒå˜é‡å¯†é’¥æº**ï¼ˆåŸºç¡€å®ç°ï¼‰
   - ç®€å•ç›´æ¥
   - é€‚åˆæœ¬åœ°å¼€å‘
   - æ ¼å¼ï¼š`SECRET_<KEY_NAME>`

3. **æœ¬åœ°å¯†é’¥æ–‡ä»¶**ï¼ˆåŸºç¡€å®ç°ï¼‰
   - `config/secrets/<env>.yaml`
   - å¯é€‰åŠ å¯†å­˜å‚¨ï¼ˆä½¿ç”¨ Fernetï¼‰
   - ä¸æäº¤åˆ° Git

**æ’ä»¶æä¾›ï¼ˆå¯é€‰ï¼‰**ï¼š
1. **Vault æ’ä»¶**ï¼ˆ`aurimyth-foundation-kit-vault`ï¼‰
   - é›†æˆ HashiCorp Vault
   - æ”¯æŒåŠ¨æ€å¯†é’¥
   - æ”¯æŒå¯†é’¥è½®æ¢
   - æ”¯æŒå®¡è®¡æ—¥å¿—

2. **AWS Secrets Manager æ’ä»¶**ï¼ˆ`aurimyth-foundation-kit-aws-secrets`ï¼‰
   - é›†æˆ AWS Secrets Manager
   - ä¸ AWS æœåŠ¡é›†æˆ
   - è‡ªåŠ¨åŠ å¯†
   - ç‰ˆæœ¬ç®¡ç†

3. **å…¶ä»–å¯†é’¥æºæ’ä»¶**ï¼ˆæŒ‰éœ€æ‰©å±•ï¼‰
   - Azure Key Vault
   - Google Secret Manager
   - è‡ªå®šä¹‰å¯†é’¥æº

**å¯†é’¥é…ç½®ç¤ºä¾‹**ï¼š
```yaml
# config/secrets/production.yamlï¼ˆåŠ å¯†ï¼‰
database:
  password: "encrypted:gAAAAABh..."  # åŠ å¯†åçš„å¯†ç 

redis:
  password: "encrypted:gAAAAABh..."

api_keys:
  third_party_api: "encrypted:gAAAAABh..."
```

**å¯†é’¥æ³¨å…¥æœºåˆ¶**ï¼š
- é…ç½®ç±»ä¸­æ ‡è®°éœ€è¦å¯†é’¥çš„å­—æ®µï¼ˆä½¿ç”¨ `SecretField`ï¼‰
- é…ç½®åŠ è½½æ—¶è‡ªåŠ¨ä»å¯†é’¥æºè·å–å¹¶æ³¨å…¥
- æ”¯æŒå¯†é’¥å¼•ç”¨ï¼ˆ`${vault:database/password}`ï¼‰

##### 1.3 é…ç½®ç®¡ç†å™¨è®¾è®¡

**ConfigManager èŒè´£**ï¼š
1. ç¯å¢ƒæ£€æµ‹ï¼ˆä»ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶ï¼‰
2. é…ç½®æ–‡ä»¶åŠ è½½å’Œåˆå¹¶
3. å¯†é’¥è·å–å’Œæ³¨å…¥
4. é…ç½®éªŒè¯ï¼ˆPydanticï¼‰
5. é…ç½®ç¼“å­˜ï¼ˆé¿å…é‡å¤åŠ è½½ï¼‰

**é…ç½®åˆå¹¶ç­–ç•¥**ï¼š
- æ·±åº¦åˆå¹¶ï¼ˆdeep mergeï¼‰
- åˆ—è¡¨åˆå¹¶ç­–ç•¥ï¼šç¯å¢ƒé…ç½®æ›¿æ¢ base é…ç½®ï¼ˆä¸åˆå¹¶ï¼‰
- å­—å…¸åˆå¹¶ç­–ç•¥ï¼šç¯å¢ƒé…ç½®è¦†ç›– base é…ç½®çš„å¯¹åº”é”®

**é…ç½®éªŒè¯**ï¼š
- ä½¿ç”¨ Pydantic è¿›è¡Œç±»å‹éªŒè¯
- å¿…éœ€å­—æ®µæ£€æŸ¥
- é…ç½®å€¼èŒƒå›´æ£€æŸ¥ï¼ˆå¦‚ç«¯å£èŒƒå›´ï¼‰
- é…ç½®ä¾èµ–æ£€æŸ¥ï¼ˆå¦‚æ•°æ®åº“ URL æ ¼å¼ï¼‰

##### 1.4 ä½¿ç”¨æ–¹å¼è®¾è®¡

**æ–¹å¼ä¸€ï¼šç¯å¢ƒå˜é‡æ§åˆ¶ï¼ˆæ¨èï¼‰**
```bash
# è®¾ç½®ç¯å¢ƒ
export ENV=production
export VAULT_ADDR=https://vault.example.com
export VAULT_TOKEN=xxx

# åº”ç”¨è‡ªåŠ¨åŠ è½½é…ç½®
python main.py
```

**æ–¹å¼äºŒï¼šä»£ç ä¸­æŒ‡å®š**
```python
from aurimyth.foundation_kit.config import ConfigManager
from aurimyth.foundation_kit.config.secrets import FileSecretManager

# ä½¿ç”¨æ¡†æ¶å†…çš„æ–‡ä»¶å¯†é’¥æº
config = ConfigManager(
    env="production",
    config_dir="config",
    secret_manager=FileSecretManager(encrypted=True),
)

# æˆ–ä½¿ç”¨ Vault æ’ä»¶
from aurimyth_foundation_kit_vault import VaultSecretManager

config = ConfigManager(
    env="production",
    secret_manager=VaultSecretManager(
        vault_addr="https://vault.example.com",
    ),
)
```

**æ–¹å¼ä¸‰ï¼šç»§æ‰¿ BaseConfig**
```python
from aurimyth.foundation_kit.application.config import BaseConfig

# è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå¹¶åŠ è½½é…ç½®
config = BaseConfig()  # ä» ENV ç¯å¢ƒå˜é‡è·å–ç¯å¢ƒ
```

##### 1.5 é…ç½®æ–‡ä»¶æ ¼å¼

**YAML æ ¼å¼ï¼ˆæ¨èï¼‰**ï¼š
```yaml
# config/base.yaml
database:
  host: "localhost"
  port: 5432
  pool_size: 5

cache:
  type: "redis"
  max_size: 1000

# config/production.yaml
database:
  host: "prod-db.example.com"
  pool_size: 20  # è¦†ç›– base é…ç½®

cache:
  type: "redis"
  redis_url: "${secret:cache/redis_url}"  # ä»å¯†é’¥ç®¡ç†å™¨è·å–ï¼ˆæ¡†æ¶ç»Ÿä¸€æ¥å£ï¼‰
```

**ç¯å¢ƒå˜é‡æ ¼å¼**ï¼š
```bash
# .env
ENV=development
DATABASE_HOST=localhost
DATABASE_PORT=5432

# å¯†é’¥ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
SECRET_DATABASE_PASSWORD=dev_password
```

##### 1.6 å¯†é’¥ç®¡ç†å®ç°ç»†èŠ‚

**æ¡†æ¶å†…å®ç°ï¼ˆæ ¸å¿ƒï¼‰**ï¼š

**SecretManager æ¥å£**ï¼š
```python
# æ¡†æ¶æä¾›æ¥å£
class SecretManager(ABC):
    @abstractmethod
    async def get_secret(self, key: str) -> str:
        """è·å–å¯†é’¥"""
        pass
    
    @abstractmethod
    async def get_secrets(self, prefix: str) -> dict[str, str]:
        """æ‰¹é‡è·å–å¯†é’¥"""
        pass
```

**ç¯å¢ƒå˜é‡å¯†é’¥æº**ï¼š
- å®ç° `EnvironmentSecretManager`
- ä»ç¯å¢ƒå˜é‡è¯»å–ï¼ˆ`SECRET_<KEY_NAME>`ï¼‰
- æ— éœ€é¢å¤–ä¾èµ–

**æœ¬åœ°æ–‡ä»¶å¯†é’¥æº**ï¼š
- å®ç° `FileSecretManager`
- ä» `config/secrets/<env>.yaml` è¯»å–
- å¯é€‰åŠ å¯†ï¼ˆä½¿ç”¨ `cryptography` åº“ï¼‰
- å¼€å‘ç¯å¢ƒå¯é€‰é¡¹ï¼ˆä¸å¼ºåˆ¶åŠ å¯†ï¼‰

**æ’ä»¶å®ç°ï¼ˆå¯é€‰ï¼‰**ï¼š

**Vault æ’ä»¶**ï¼ˆ`aurimyth-foundation-kit-vault`ï¼‰ï¼š
- ä½¿ç”¨ `hvac` åº“è¿æ¥ Vault
- æ”¯æŒ KV v1 å’Œ KV v2
- æ”¯æŒåŠ¨æ€å¯†é’¥ï¼ˆå¦‚æ•°æ®åº“å‡­è¯ï¼‰
- æ”¯æŒå¯†é’¥è½®æ¢ç›‘å¬
- å®ç° `VaultSecretManager`

**AWS Secrets Manager æ’ä»¶**ï¼ˆ`aurimyth-foundation-kit-aws-secrets`ï¼‰ï¼š
- ä½¿ç”¨ `boto3` è¿æ¥ AWS
- æ”¯æŒåŒºåŸŸé€‰æ‹©
- æ”¯æŒå¯†é’¥ç‰ˆæœ¬ç®¡ç†
- æ”¯æŒè‡ªåŠ¨åˆ·æ–°
- å®ç° `AWSSecretManager`

##### 1.7 é…ç½®çƒ­é‡è½½ï¼ˆå¯é€‰ï¼‰

**è®¾è®¡**ï¼š
- ç›‘å¬é…ç½®æ–‡ä»¶å˜åŒ–
- æ”¯æŒé…ç½®çƒ­é‡è½½ï¼ˆä¸é‡å¯åº”ç”¨ï¼‰
- é…ç½®å˜æ›´äº‹ä»¶é€šçŸ¥
- ç»„ä»¶è‡ªåŠ¨å“åº”é…ç½®å˜æ›´

**ä½¿ç”¨åœºæ™¯**ï¼š
- å¼€å‘ç¯å¢ƒï¼šè‡ªåŠ¨é‡è½½é…ç½®
- ç”Ÿäº§ç¯å¢ƒï¼šæ‰‹åŠ¨è§¦å‘é‡è½½ï¼ˆé€šè¿‡ APIï¼‰

##### 1.8 é…ç½®éªŒè¯å’Œé”™è¯¯å¤„ç†

**éªŒè¯è§„åˆ™**ï¼š
- ç±»å‹éªŒè¯ï¼ˆPydanticï¼‰
- å¿…éœ€å­—æ®µæ£€æŸ¥
- å€¼èŒƒå›´æ£€æŸ¥ï¼ˆç«¯å£ã€è¶…æ—¶ç­‰ï¼‰
- æ ¼å¼éªŒè¯ï¼ˆURLã€é‚®ç®±ç­‰ï¼‰
- ä¾èµ–æ£€æŸ¥ï¼ˆå¦‚æ•°æ®åº“ URL æ ¼å¼ï¼‰

**é”™è¯¯å¤„ç†**ï¼š
- é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼šä½¿ç”¨é»˜è®¤é…ç½®æˆ–æŠ›å‡ºæ˜ç¡®é”™è¯¯
- å¯†é’¥è·å–å¤±è´¥ï¼šæŠ›å‡ºæ˜ç¡®é”™è¯¯ï¼Œä¸é™é»˜å¤±è´¥
- é…ç½®éªŒè¯å¤±è´¥ï¼šåˆ—å‡ºæ‰€æœ‰éªŒè¯é”™è¯¯
- é…ç½®åˆå¹¶å†²çªï¼šè®°å½•è­¦å‘Šï¼Œä½¿ç”¨ä¼˜å…ˆçº§é«˜çš„é…ç½®

##### 1.9 å®æ–½è®¡åˆ’

**é˜¶æ®µä¸€ï¼šå¤šç¯å¢ƒé…ç½®ï¼ˆæ¡†æ¶å†…ï¼‰**
1. å®ç° `ConfigManager` ç±»
2. æ”¯æŒ YAML é…ç½®æ–‡ä»¶åŠ è½½
3. å®ç°é…ç½®åˆå¹¶é€»è¾‘
4. æ”¯æŒç¯å¢ƒå˜é‡æ§åˆ¶

**é˜¶æ®µäºŒï¼šå¯†é’¥ç®¡ç†åŸºç¡€ï¼ˆæ¡†æ¶å†…ï¼‰**
1. å®ç° `SecretManager` æ¥å£ï¼ˆæŠ½è±¡å±‚ï¼‰
2. å®ç° `EnvironmentSecretManager`ï¼ˆç¯å¢ƒå˜é‡ï¼‰
3. å®ç° `FileSecretManager`ï¼ˆæœ¬åœ°æ–‡ä»¶ï¼‰
4. å®ç°å¯†é’¥æ³¨å…¥æœºåˆ¶
5. æ”¯æŒå¯†é’¥å¼•ç”¨ï¼ˆ`${secret:database/password}`ï¼‰

**é˜¶æ®µä¸‰ï¼šVault æ’ä»¶ï¼ˆç‹¬ç«‹æ’ä»¶åŒ…ï¼‰**
1. åˆ›å»º `aurimyth-foundation-kit-vault` æ’ä»¶åŒ…
2. å®ç° `VaultSecretManager`
3. é›†æˆ HashiCorp Vault
4. æ”¯æŒåŠ¨æ€å¯†é’¥å’Œå¯†é’¥è½®æ¢

**é˜¶æ®µå››ï¼šAWS Secrets Manager æ’ä»¶ï¼ˆç‹¬ç«‹æ’ä»¶åŒ…ï¼‰**
1. åˆ›å»º `aurimyth-foundation-kit-aws-secrets` æ’ä»¶åŒ…
2. å®ç° `AWSSecretManager`
3. é›†æˆ AWS Secrets Manager
4. æ”¯æŒåŒºåŸŸå’Œç‰ˆæœ¬ç®¡ç†

**æ’ä»¶ä½¿ç”¨æ–¹å¼**ï¼š
```python
# å®‰è£…æ’ä»¶
pip install aurimyth-foundation-kit-vault

# ä½¿ç”¨æ’ä»¶
from aurimyth_foundation_kit_vault import VaultSecretManager

config = ConfigManager(
    env="production",
    secret_manager=VaultSecretManager(
        vault_addr="https://vault.example.com",
        vault_token="xxx",
    ),
)
```

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ **é«˜**ï¼ˆå¤šç¯å¢ƒéƒ¨ç½²å¿…éœ€ï¼‰

---

## ğŸ”µ ç¬¬ä¸‰éƒ¨åˆ†ï¼šCore å±‚æ·±åº¦ä¼˜åŒ–ï¼ˆæ¡†æ¶æ ¸å¿ƒèƒ½åŠ›å¢å¼ºï¼‰

### æ¦‚è¿°

è¿™äº›ä¼˜åŒ–ä»»åŠ¡æ—¨åœ¨æå‡ Core å±‚ï¼ˆModelsã€Repositoryã€Serviceï¼‰çš„å¥å£®æ€§ã€æ€§èƒ½å’Œæ˜“ç”¨æ€§ã€‚è¿™äº›ä¸æ˜¯"ç¼ºå¤±åŠŸèƒ½"ï¼Œè€Œæ˜¯"æ·±åº¦ä¼˜åŒ–"ã€‚

è¯¦ç»†ä»»åŠ¡æ¸…å•è¯·å‚è€ƒï¼š`CORE_LAYER_OPTIMIZATION_TODO.md`

---

### 1. **æ¨¡å‹åŸºç±»ä¼˜åŒ–** â­â­â­â­

#### å½“å‰é—®é¢˜ï¼š
- âš ï¸ `datetime.utcnow` å·²å¼ƒç”¨ï¼ˆPython 3.12+ï¼‰
- âš ï¸ è½¯åˆ é™¤æœºåˆ¶ä¸å¤Ÿçµæ´»ï¼ˆåªæœ‰ `yn` å­—æ®µï¼‰
- âš ï¸ ç¼ºå°‘ UUID ä¸»é”®æ”¯æŒ
- âš ï¸ ç¼ºå°‘ç‰ˆæœ¬æ§åˆ¶ï¼ˆä¹è§‚é”ï¼‰

#### å»ºè®®è¡¥å……ï¼š

##### 1.1 ä¿®å¤æ—¶é—´æˆ³å­—æ®µ
```python
# ä¿®å¤å‰
created_at = Column(DateTime, default=datetime.utcnow)  # âŒ å·²å¼ƒç”¨

# ä¿®å¤å
from sqlalchemy import func
created_at = Column(DateTime, server_default=func.now())  # âœ… æ¨è
```

##### 1.2 è½¯åˆ é™¤æœºåˆ¶æ‰©å±•
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.models import SoftDeleteModel

class User(SoftDeleteModel):
    # è‡ªåŠ¨åŒ…å« deleted_at å­—æ®µ
    pass

# Repository æ”¯æŒ
await repo.soft_delete(user)  # è®¾ç½® deleted_at
await repo.hard_delete(user)   # ç‰©ç†åˆ é™¤
```

##### 1.3 UUID ä¸»é”®æ”¯æŒ
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.models import UUIDModel

class User(UUIDModel):
    # è‡ªåŠ¨ä½¿ç”¨ UUID ä¸»é”®
    pass
```

##### 1.4 ç‰ˆæœ¬æ§åˆ¶ï¼ˆä¹è§‚é”ï¼‰
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.models import VersionedModel

class User(VersionedModel):
    # è‡ªåŠ¨åŒ…å« version å­—æ®µ
    pass

# Repository è‡ªåŠ¨æ£€æŸ¥ç‰ˆæœ¬
await repo.update(user, data)  # å¦‚æœ version ä¸åŒ¹é…ï¼ŒæŠ›å‡º StaleObjectError
```

**ä¼˜å…ˆçº§**ï¼šğŸ”´ **é«˜**ï¼ˆæ ¸å¿ƒåŠŸèƒ½ä¿®å¤ï¼‰

---

### 2. **ORM å¯æ‰©å±•æ€§** â­â­â­â­â­

#### å½“å‰é—®é¢˜ï¼š
- âš ï¸ **ORM ä¾èµ–è¿‡æ­»**ï¼Œç›´æ¥ç»‘å®š SQLAlchemy
- âš ï¸ `BaseModel` ç›´æ¥ç»§æ‰¿ SQLAlchemy çš„ `declarative_base()`
- âš ï¸ `BaseRepository` ç›´æ¥ä½¿ç”¨ `AsyncSession`ã€`Select` ç­‰ SQLAlchemy ç±»å‹
- âš ï¸ `BaseService` ç›´æ¥ä½¿ç”¨ `AsyncSession`
- âš ï¸ æ— æ³•æ›¿æ¢ä¸ºå…¶ä»– ORMï¼ˆå¦‚ Tortoise ORMã€Peeweeã€SQLModel ç­‰ï¼‰

#### é¡¶çº§æ¡†æ¶å¯¹æ¯”ï¼š
- **Spring Boot**: âœ… JPA æŠ½è±¡å±‚ï¼Œæ”¯æŒ Hibernateã€EclipseLink ç­‰å¤šç§å®ç°
- **Django**: âš ï¸ ç»‘å®š Django ORMï¼Œä½†æä¾›æ•°æ®åº“è·¯ç”±æ”¯æŒå¤šæ•°æ®åº“
- **Laravel**: âš ï¸ ç»‘å®š Eloquentï¼Œä½†æä¾›æŸ¥è¯¢æ„å»ºå™¨æŠ½è±¡
- **Rails**: âš ï¸ ç»‘å®š ActiveRecordï¼Œä½†æä¾›æ•°æ®åº“é€‚é…å™¨æŠ½è±¡
- **NestJS**: âœ… TypeORM æŠ½è±¡ï¼Œæ”¯æŒå¤šç§ ORMï¼ˆTypeORMã€Sequelizeã€Prismaï¼‰

#### å½±å“ï¼š
- æ— æ³•æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©æœ€é€‚åˆçš„ ORM
- è¿ç§»åˆ°å…¶ä»– ORM éœ€è¦å¤§é‡é‡æ„
- æµ‹è¯•æ—¶æ— æ³•ä½¿ç”¨è½»é‡çº§ ORMï¼ˆå¦‚ InMemory ORMï¼‰
- å¤šæ•°æ®åº“æ”¯æŒå›°éš¾

#### å»ºè®®è¡¥å……ï¼š

##### 2.1 ORM æŠ½è±¡å±‚
```python
# åº”è¯¥æä¾› ORM æŠ½è±¡æ¥å£
from aurimyth.foundation_kit.core.orm import ORMAdapter, Session, Query

# ORM é€‚é…å™¨æ¥å£
class ORMAdapter(ABC):
    """ORM é€‚é…å™¨æŠ½è±¡æ¥å£ã€‚"""
    
    @abstractmethod
    def create_session(self) -> Session:
        """åˆ›å»ºæ•°æ®åº“ä¼šè¯ã€‚"""
        pass
    
    @abstractmethod
    def create_query(self, model_class) -> Query:
        """åˆ›å»ºæŸ¥è¯¢å¯¹è±¡ã€‚"""
        pass

# SQLAlchemy å®ç°
class SQLAlchemyAdapter(ORMAdapter):
    """SQLAlchemy ORM é€‚é…å™¨ã€‚"""
    def create_session(self) -> SQLAlchemySession:
        pass

# Tortoise ORM å®ç°
class TortoiseAdapter(ORMAdapter):
    """Tortoise ORM é€‚é…å™¨ã€‚"""
    def create_session(self) -> TortoiseSession:
        pass
```

##### 2.2 æ¨¡å‹åŸºç±»æŠ½è±¡
```python
# åº”è¯¥æä¾› ORM æ— å…³çš„æ¨¡å‹åŸºç±»
from aurimyth.foundation_kit.core.models import BaseModel, ModelMeta

class BaseModel(ABC):
    """ORM æ— å…³çš„æ¨¡å‹åŸºç±»ã€‚"""
    
    @classmethod
    @abstractmethod
    def get_orm_adapter(cls) -> ORMAdapter:
        """è·å– ORM é€‚é…å™¨ã€‚"""
        pass

# SQLAlchemy å®ç°
class SQLAlchemyModel(BaseModel):
    """SQLAlchemy æ¨¡å‹åŸºç±»ã€‚"""
    __orm_adapter__ = SQLAlchemyAdapter()
    
    # ä½¿ç”¨ SQLAlchemy å®šä¹‰
    id = Column(Integer, primary_key=True)

# Tortoise ORM å®ç°
class TortoiseModel(BaseModel):
    """Tortoise ORM æ¨¡å‹åŸºç±»ã€‚"""
    __orm_adapter__ = TortoiseAdapter()
    
    # ä½¿ç”¨ Tortoise ORM å®šä¹‰
    id = fields.IntField(pk=True)
```

##### 2.3 Repository æŠ½è±¡
```python
# åº”è¯¥æä¾› ORM æ— å…³çš„ Repository
from aurimyth.foundation_kit.core.repository import BaseRepository, Session

class BaseRepository(IRepository[ModelType]):
    """ORM æ— å…³çš„ Repository åŸºç±»ã€‚"""
    
    def __init__(self, session: Session, model_class: type[ModelType]) -> None:
        """åˆå§‹åŒ– Repositoryã€‚
        
        Args:
            session: ORM æ— å…³çš„ä¼šè¯æ¥å£
            model_class: æ¨¡å‹ç±»
        """
        self._session = session
        self._model_class = model_class
        self._orm_adapter = model_class.get_orm_adapter()
    
    async def get(self, id: int) -> ModelType | None:
        """æ ¹æ®IDè·å–å®ä½“ï¼ˆORM æ— å…³ï¼‰ã€‚"""
        query = self._orm_adapter.create_query(self._model_class)
        return await query.filter(id=id).first()
```

##### 2.4 é…ç½®åŒ– ORM é€‰æ‹©
```python
# åº”è¯¥æ”¯æŒé…ç½®åŒ–é€‰æ‹© ORM
from aurimyth.foundation_kit.application.config import BaseConfig

class DatabaseSettings(BaseConfig):
    orm_type: str = "sqlalchemy"  # æˆ– "tortoise", "peewee", "sqlmodel"
    sqlalchemy_url: str | None = None
    tortoise_config: dict | None = None
```

##### 2.5 å¤š ORM æ”¯æŒç¤ºä¾‹
```python
# ä½¿ç”¨ SQLAlchemy
from aurimyth.foundation_kit.core.models.sqlalchemy import SQLAlchemyModel

class User(SQLAlchemyModel):
    __tablename__ = "users"
    id = Column(Integer, primary_key=True)

# ä½¿ç”¨ Tortoise ORM
from aurimyth.foundation_kit.core.models.tortoise import TortoiseModel

class User(TortoiseModel):
    id = fields.IntField(pk=True)

# Repository è‡ªåŠ¨é€‚é…
repo = UserRepository(session)  # è‡ªåŠ¨ä½¿ç”¨å¯¹åº”çš„ ORM é€‚é…å™¨
```

**ä¼˜åŠ¿**ï¼š
- âœ… å¯ä»¥æ›¿æ¢ ORMï¼ˆSQLAlchemyã€Tortoise ORMã€Peeweeã€SQLModelï¼‰
- âœ… æµ‹è¯•æ—¶å¯ä»¥ä½¿ç”¨è½»é‡çº§ ORM
- âœ… æ”¯æŒå¤šæ•°æ®åº“ï¼ˆä¸åŒæ¨¡å‹ä½¿ç”¨ä¸åŒ ORMï¼‰
- âœ… æ›´å¥½çš„å¯æµ‹è¯•æ€§ï¼ˆå¯ä»¥ Mock ORM å±‚ï¼‰

**ä¼˜å…ˆçº§**ï¼šğŸ”´ **é«˜**ï¼ˆæå‡æ¡†æ¶çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼‰

---

### 3. **Repository æ¨¡å¼å¢å¼º** â­â­â­â­â­

#### å½“å‰é—®é¢˜ï¼š
- âš ï¸ æŸ¥è¯¢æ„å»ºå™¨åŠŸèƒ½æœ‰é™ï¼ˆåªæ”¯æŒç­‰å€¼æŸ¥è¯¢ï¼‰
- âš ï¸ æ‰¹é‡æ“ä½œæ€§èƒ½ä¸ä½³
- âš ï¸ ç¼ºå°‘åˆ†é¡µå’Œæ’åºæ ‡å‡†åŒ–
- âš ï¸ ç¼ºå°‘äº‹åŠ¡è¾¹ç•Œæ£€æŸ¥
- âš ï¸ ç¼ºå°‘æŸ¥è¯¢ç¼“å­˜å’Œæ€§èƒ½ç›‘æ§

#### å»ºè®®è¡¥å……ï¼š

##### 2.1 æŸ¥è¯¢æ„å»ºå™¨å¢å¼º
```python
# åº”è¯¥æ”¯æŒ
from aurimyth.foundation_kit.core.repository import BaseRepository

repo = UserRepository(session)

# æ“ä½œç¬¦æ”¯æŒ
users = await repo.list(age__gt=18, name__like="å¼ %", status__in=[1, 2, 3])

# é“¾å¼æŸ¥è¯¢
users = await repo.query().filter(age__gt=18).order_by("-created_at").limit(10).all()
```

##### 2.2 æ‰¹é‡æ“ä½œä¼˜åŒ–
```python
# åº”è¯¥æä¾›
await repo.batch_create([...])  # ä½¿ç”¨ bulk_insert_mappings
await repo.batch_update([...])  # æ‰¹é‡æ›´æ–°
await repo.bulk_upsert([...])   # æ‰¹é‡æ’å…¥æˆ–æ›´æ–°
```

##### 2.3 åˆ†é¡µå’Œæ’åºæ ‡å‡†åŒ–
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.repository import PaginationParams, SortParams

result = await repo.paginate(
    PaginationParams(page=1, page_size=20),
    SortParams([("created_at", "desc"), ("id", "asc")])
)
# è¿”å› PaginationResult[T] åŒ…å« items, total, page, page_size ç­‰
```

##### 2.4 äº‹åŠ¡è¾¹ç•Œæ£€æŸ¥
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.repository import requires_transaction

@requires_transaction
async def update_user(repo, user, data):
    # å¦‚æœä¸åœ¨äº‹åŠ¡ä¸­ï¼ŒæŠ›å‡º TransactionRequiredError
    await repo.update(user, data)
```

##### 2.5 æŸ¥è¯¢ç¼“å­˜
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.repository import cache_query

@cache_query(ttl=300, key_prefix="user")
async def get_user_by_id(self, id: int):
    return await self.get(id)
```

##### 2.6 QueryInterceptor æ¥å£
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.repository import QueryInterceptor

class AuditInterceptor(QueryInterceptor):
    async def before_query(self, query, **kwargs):
        # è‡ªåŠ¨æ·»åŠ å®¡è®¡æ¡ä»¶
        pass
    
    async def after_query(self, result, **kwargs):
        # è®°å½•æŸ¥è¯¢æ—¥å¿—
        pass
```

##### 2.7 ç±»å‹å®‰å…¨å¢å¼º
```python
# åº”è¯¥æä¾›
from typing import TypedDict

class UserFilter(TypedDict, total=False):
    name: str
    age: int
    status: int

# IDE è‡ªåŠ¨è¡¥å…¨å’Œç±»å‹æ£€æŸ¥
users = await repo.list(**UserFilter(name="å¼ ä¸‰", age=18))
```

**ä¼˜å…ˆçº§**ï¼šğŸ”´ **é«˜**ï¼ˆæå‡å¼€å‘ä½“éªŒå’Œä»£ç è´¨é‡ï¼‰

---

### 4. **Service æ¨¡å¼å¢å¼º** â­â­â­â­

#### å½“å‰é—®é¢˜ï¼š
- âš ï¸ Repository éœ€è¦æ‰‹åŠ¨åˆ›å»º
- âš ï¸ ç¼ºå°‘æœåŠ¡ç»„åˆå’Œç¼–æ’èƒ½åŠ›
- âš ï¸ ç¼ºå°‘ä¸šåŠ¡äº‹ä»¶å‘å¸ƒ
- âš ï¸ ç¼ºå°‘éªŒè¯ã€ç¼“å­˜ã€ç›‘æ§è£…é¥°å™¨

#### å»ºè®®è¡¥å……ï¼š

##### 3.1 Repository è‡ªåŠ¨æ³¨å…¥
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.service import BaseService, inject_repository

class UserService(BaseService):
    # è‡ªåŠ¨æ³¨å…¥ï¼Œæ”¯æŒå¤šä¸ª Repository
    user_repo: UserRepository = inject_repository()
    profile_repo: ProfileRepository = inject_repository()
```

##### 3.2 äº‹åŠ¡ç®¡ç†å¢å¼º
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.service import transactional, readonly

@transactional(propagation=Propagation.REQUIRES_NEW)
async def create_user(self, data):
    # æ”¯æŒäº‹åŠ¡ä¼ æ’­çº§åˆ«
    pass

@readonly
async def get_user(self, id: int):
    # åªè¯»äº‹åŠ¡ä¼˜åŒ–
    pass
```

##### 3.3 ä¸šåŠ¡äº‹ä»¶å‘å¸ƒ
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.service import publish_event

@publish_event("user.created", after_commit=True)
@transactional
async def create_user(self, data):
    user = await self.user_repo.create(data)
    return user  # äº‹åŠ¡æäº¤åè‡ªåŠ¨å‘å¸ƒäº‹ä»¶
```

##### 3.4 éªŒè¯è£…é¥°å™¨
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.service import validate
from pydantic import BaseModel

class CreateUserRequest(BaseModel):
    name: str
    email: str

@validate
async def create_user(self, data: CreateUserRequest):
    # è‡ªåŠ¨éªŒè¯å‚æ•°
    pass
```

##### 3.5 æœåŠ¡å±‚ç¼“å­˜
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.service import cache_result

@cache_result(ttl=300, key=lambda self, id: f"user:{id}")
async def get_user(self, id: int):
    return await self.user_repo.get(id)
```

##### 3.6 æ€§èƒ½ç›‘æ§è£…é¥°å™¨
```python
# åº”è¯¥æä¾›
from aurimyth.foundation_kit.core.service import monitor

@monitor(metrics=True, slow_threshold=1.0)
async def create_user(self, data):
    # è‡ªåŠ¨è®°å½•æ‰§è¡Œæ—¶é—´å’Œè°ƒç”¨æ¬¡æ•°
    pass
```

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ **ä¸­**ï¼ˆæå‡å¼€å‘ä½“éªŒï¼Œéå¿…éœ€ï¼‰

---

## ğŸ“Š ä¼˜å…ˆçº§æ€»ç»“

### ğŸ”´ æé«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å®æ–½ï¼‰

1. **å¯è§‚æµ‹æ€§å¢å¼º** - ç”Ÿäº§ç¯å¢ƒç›‘æ§å¿…éœ€

### ğŸŸ¡ é«˜ä¼˜å…ˆçº§ï¼ˆè¿‘æœŸå®æ–½ï¼‰

2. **æµ‹è¯•æ¡†æ¶å¢å¼º** - æé«˜å¼€å‘æ•ˆç‡
3. **é…ç½®ç®¡ç†å¢å¼º** - å¤šç¯å¢ƒéƒ¨ç½²å¿…éœ€
4. **æ—¶åŒºå¤„ç†å¢å¼º** - å®Œå–„æ—¶åŒºè½¬æ¢åŠŸèƒ½
5. **ORM å¯æ‰©å±•æ€§** - æå‡æ¡†æ¶çµæ´»æ€§å’Œå¯æ‰©å±•æ€§
6. **Core å±‚ä¼˜åŒ–ï¼ˆæ¨¡å‹ã€Repositoryï¼‰** - æå‡ä»£ç è´¨é‡
7. **å®‰å…¨åˆè§„ï¼ˆæ•°æ®è„±æ•ï¼‰** - åº”ç”¨å±‚å·¥å…·

### ğŸŸ¢ ä¸­ä¼˜å…ˆçº§ï¼ˆæŒ‰éœ€å®æ–½ï¼‰

8. **Core å±‚ä¼˜åŒ–ï¼ˆServiceï¼‰** - æå‡å¼€å‘ä½“éªŒ

---

## ğŸš€ å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µï¼šå®‰å…¨æ ¸å¿ƒï¼ˆ1-3ä¸ªæœˆï¼‰
1. âœ… å¯è§‚æµ‹æ€§å¢å¼ºï¼ˆå¥åº·æ£€æŸ¥ã€æŒ‡æ ‡ã€è¿½è¸ªï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šå¼€å‘æ•ˆç‡ï¼ˆ4-6ä¸ªæœˆï¼‰
3. âœ… æµ‹è¯•æ¡†æ¶å¢å¼º
4. âœ… é…ç½®ç®¡ç†å¢å¼º
5. âœ… æ—¶åŒºå¤„ç†å¢å¼ºï¼ˆå®Œå–„æ—¶åŒºè½¬æ¢åŠŸèƒ½ï¼‰
6. âœ… ORM å¯æ‰©å±•æ€§ï¼ˆæŠ½è±¡å±‚ã€å¤š ORM æ”¯æŒï¼‰
7. âœ… Core å±‚ä¼˜åŒ–ï¼ˆæ¨¡å‹ã€Repositoryï¼‰

### ç¬¬ä¸‰é˜¶æ®µï¼šä½“éªŒä¼˜åŒ–ï¼ˆ7-9ä¸ªæœˆï¼‰
8. âœ… Core å±‚ä¼˜åŒ–ï¼ˆServiceï¼‰

---

## ğŸ’¡ ç»“è®º

### **çœŸå®å·®è·åˆ†æ**ï¼š

1. **å¯è§‚æµ‹æ€§å¢å¼º** - ğŸ”´ æé«˜ä¼˜å…ˆçº§
   - Spring Bootã€NestJS åŸç”Ÿæ”¯æŒ
   - Kit åªæœ‰åŸºç¡€æ”¯æŒ
   - ç”Ÿäº§ç¯å¢ƒç›‘æ§å¿…éœ€

2. **å®‰å…¨åˆè§„** - ğŸŸ¡ ä¸­ä¼˜å…ˆçº§
   - é™æµï¼šç”±ç½‘å…³å±‚æä¾›ï¼ˆæ¶æ„è®¾è®¡ï¼‰
   - API Keyï¼šå¯ç”±ç½‘å…³å±‚æˆ–ç”¨æˆ·æœåŠ¡æä¾›
   - æ•°æ®è„±æ•ï¼šåº”ç”¨å±‚å·¥å…·ï¼ˆéœ€è¦è¡¥å……ï¼‰

3. **æµ‹è¯•æ¡†æ¶å¢å¼º** - ğŸŸ¡ é«˜ä¼˜å…ˆçº§
   - æ‰€æœ‰æ¡†æ¶éƒ½æœ‰å®Œæ•´æ”¯æŒ
   - Kit åŸºç¡€æ”¯æŒï¼Œéœ€å¢å¼º

5. **æ•°æ®åº“è¿ç§»å·¥å…·** - âœ… å·²å®Œæ•´å®ç°
   - Djangoã€Laravelã€Rails åŸç”Ÿæ”¯æŒ
   - Kit æœ‰åŸºç¡€æ”¯æŒï¼Œéœ€å¢å¼ºä¾¿åˆ©æ€§

### **Kit çš„ä¼˜åŠ¿**ï¼š

- âœ… **å¼‚æ­¥æ”¯æŒ**ï¼šåŸç”Ÿå¼‚æ­¥ï¼Œæ€§èƒ½ä¼˜äº Djangoã€Laravelã€Rails
- âœ… **ç±»å‹æç¤º**ï¼šå®Œæ•´çš„ç±»å‹æç¤ºï¼Œä¼˜äº Djangoã€Laravelã€Rails
- âœ… **API æ–‡æ¡£**ï¼šè‡ªåŠ¨ç”Ÿæˆ OpenAPI æ–‡æ¡£ï¼Œä¼˜äºæ‰€æœ‰æ¡†æ¶
- âœ… **ç»„ä»¶åŒ–æ¶æ„**ï¼šçµæ´»çš„ç»„ä»¶ç³»ç»Ÿï¼Œä¼˜äº Flaskã€FastAPI
- âœ… **Repository æ¨¡å¼**ï¼šåŸç”Ÿæ”¯æŒï¼Œä¼˜äº Djangoã€Laravel

### **æ€»ç»“**ï¼š

Kit ä¸é¡¶çº§æ¡†æ¶çš„çœŸå®å·®è·ä¸»è¦é›†ä¸­åœ¨**å®‰å…¨ã€å¯è§‚æµ‹æ€§ã€æµ‹è¯•**ä¸‰ä¸ªæ–¹é¢ã€‚è¿™äº›åŠŸèƒ½éƒ½æ˜¯ä¼ä¸šçº§åº”ç”¨çš„æ ¸å¿ƒéœ€æ±‚ï¼Œå»ºè®®ä¼˜å…ˆå®æ–½ã€‚Core å±‚çš„ä¼˜åŒ–å¯ä»¥é€æ­¥è¿›è¡Œï¼Œæå‡æ¡†æ¶çš„å¥å£®æ€§å’Œæ˜“ç”¨æ€§ã€‚
